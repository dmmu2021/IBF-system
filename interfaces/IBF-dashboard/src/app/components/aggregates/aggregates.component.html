<div *ngIf="showAggregatesSection()">
  <ion-grid class="ion-no-padding">
    <ion-row
      class="component-title"
      style="background: var(--ion-color-ibf-secondary)"
      data-test="action-title"
    >
      <ion-col class="ion-no-padding">
        <ion-item
          lines="none"
          class="component-title-item ion-no-margin"
          [color]="isActiveAreas() ? 'ibf-secondary' : 'ibf-no-alert-tertiary'"
        >
          <ion-col class="ion-no-padding ion-no-margin ion-align-items-center">
            <ion-label
              class="aggregates--title ion-no-margin"
              data-test="aggregate-title"
              [title]="
                ('aggregates-component.header-title-prefix' | translate) +
                ' ' +
                getNumberAreasExposed() +
                ' ' +
                getLabelAreasExposed().headerLabel
              "
            >
              <strong>
                <ion-text
                  [color]="isActiveAreas() ? 'ibf-primary' : 'ibf-black'"
                  style="font-size: 20px"
                  >{{ getNumberAreasExposed() }}</ion-text
                >
                <span style="color: var(--ion-color-ibf-black)">
                  {{ getLabelAreasExposed().headerLabel }}
                </span>
                <span
                  style="color: var(--ion-color-ibf-black)"
                  *ngIf="!isActiveAreas() && (placeCode || placeCodeHover)"
                  >{{ ' '
                  }}{{
                    'aggregates-component.stopped-placecode' | translate
                  }}</span
                >
              </strong>
            </ion-label>
            <ion-label
              *ngIf="getLabelAreasExposed().subHeaderLabel !== ''"
              class="aggregate--title"
            >
              <ion-text style="font-size: 12px">
                {{ getLabelAreasExposed().subHeaderLabel }}
              </ion-text>
            </ion-label>
          </ion-col>
          <ion-button
            fill="clear"
            *ngIf="showPlaceCodeView(placeCode)"
            [color]="isActiveAreas() ? 'light' : 'ibf-black'"
            class="place-code-reset-button"
            (click)="clearPlaceCode()"
          >
            <ion-icon name="close" slot="icon-only"></ion-icon>
          </ion-button>
        </ion-item>
      </ion-col>
    </ion-row>
    <div data-test="aggregate-list">
      <ion-row
        *ngFor="let indicator of indicators"
        class="ion-no-padding"
        color="ibf-white"
      >
        <ion-col size-lg="7" size-md="7" size-xs="7">
          <ion-item lines="inset" class="aggregate-item ion-no-padding">
            <ion-thumbnail
              slot="start"
              class="aggregate-item-thumbnail"
              color="ibf-tertiary"
            >
              <ion-img src="assets/icons/{{ indicator.icon }}"></ion-img>
            </ion-thumbnail>
            <ion-label class="aggregate-item-label" [title]="indicator.label">
              <span *ngIf="indicator.weightedAvg"></span>

              {{ indicator.label }}
            </ion-label>
          </ion-item>
        </ion-col>
        <ion-col size-lg="4" size-md="4" size-xs="4">
          <ion-item
            class="aggregate-item-value ion-no-padding"
            style="--inner-padding-end: 4px"
          >
            <ion-label class="ion-text-right" data-test="aggregate-number">
              <span *ngIf="indicator.numberFormatAggregate === 'decimal2'">
                {{
                  this.getAggregate(
                    indicator.name,
                    indicator.weightedAvg,
                    indicator.numberFormatAggregate
                  ) | number: '.2-2'
                }}
              </span>
              <span *ngIf="indicator.numberFormatAggregate === 'decimal0'">
                {{
                  this.getAggregate(
                    indicator.name,
                    indicator.weightedAvg,
                    indicator.numberFormatAggregate
                  ) | number: '.0-0'
                }}
              </span>
              <span *ngIf="indicator.numberFormatAggregate === 'perc'">
                {{
                  this.getAggregate(
                    indicator.name,
                    indicator.weightedAvg,
                    indicator.numberFormatAggregate
                  ) | percent: '.0-0'
                }}
              </span>
            </ion-label>
          </ion-item>
        </ion-col>
        <ion-col
          size-lg="1"
          size-md="1"
          size-xs="1"
          [title]="'aggregates-component.more-information' | translate"
        >
          <ion-item
            class="aggregate-item-information-icon ion-no-padding"
            data-test="icon-row"
            style="--inner-padding-end: 0px"
          >
            <ion-label>
              <img
                class="info-img"
                src="assets/icons/source-info.svg"
                (click)="moreInfo(indicator)"
              />
            </ion-label>
          </ion-item>
        </ion-col>
      </ion-row>
    </div>
  </ion-grid>
</div>
