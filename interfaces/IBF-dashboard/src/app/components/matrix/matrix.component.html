<div class="ibf-map-layer-control">
  <ion-menu-toggle
    menu="layer-control"
    [class.ion-hide]="hideLayerControlToggleButton"
  >
    <ion-header>
      <ion-toolbar color="ibf-no-alert-primary">
        <ion-buttons slot="end">
          <ion-icon name="chevron-down-outline"></ion-icon>
        </ion-buttons>
        <ion-title data-test="layers-toggle">Layers</ion-title>
      </ion-toolbar>
    </ion-header>
  </ion-menu-toggle>
  <ion-menu
    side="end"
    type="overlay"
    contentId="ibf-dashboard-map"
    menuId="layer-control"
    (ionDidOpen)="isLayerControlMenuOpen()"
    (ionDidClose)="isLayerControlMenuOpen()"
    data-test="layers-control-menu"
  >
    <ion-menu-toggle menu="layer-control">
      <ion-header>
        <ion-toolbar color="ibf-no-alert-primary">
          <ion-buttons slot="end">
            <ion-icon name="chevron-up-outline"></ion-icon>
          </ion-buttons>
          <ion-title>Layers</ion-title>
        </ion-toolbar>
      </ion-header>
    </ion-menu-toggle>
    <ion-content>
      <ion-list class="ion-no-padding">
        <ion-row
          *ngFor="let layer of getLayersInOrder().check"
          class="ion-justify-content-between ion-nowrap"
        >
          <ion-item lines="full">
            <ion-spinner *ngIf="layer.isLoading"></ion-spinner>
            <ion-checkbox
              *ngIf="!layer.isLoading"
              [checked]="layer.active"
              (click)="toggleLayer(layer)"
              class="ion-no-margin"
              slot="start"
            ></ion-checkbox>
            <ion-label
              class="ion-text-wrap ion-no-margin"
              [title]="layer.label"
              style="margin-left: 8px"
            >
              {{ layer.label }}
            </ion-label>
            <ion-button
              slot="end"
              fill="clear"
              class="ion-no-margin"
              (click)="presentPopover($event, layer)"
            >
              <ion-icon
                color="ibf-no-alert-primary"
                name="information-circle-outline"
                data-test="matrix-icon"
                class="info-icon"
              ></ion-icon>
            </ion-button>
          </ion-item>
        </ion-row>
        <ion-radio-group [value]="getActiveRadioLayer()">
          <ion-row
            *ngFor="let layer of getLayersInOrder().radio"
            class="ion-justify-content-between ion-nowrap"
          >
            <ion-item lines="full">
              <ion-spinner *ngIf="layer.isLoading"></ion-spinner>
              <ion-radio
                *ngIf="!layer.isLoading"
                (click)="toggleLayer(layer)"
                class="ion-no-margin menu-radio-button"
                slot="start"
                [value]="layer"
              ></ion-radio>
              <ion-label
                class="ion-text-wrap ion-no-margin"
                [title]="layer.label"
                style="margin-left: 8px"
              >
                {{ layer.label }}
              </ion-label>
              <ion-button
                slot="end"
                fill="clear"
                class="ion-no-margin"
                (click)="presentPopover($event, layer)"
              >
                <ion-icon
                  color="ibf-no-alert-primary"
                  name="information-circle-outline"
                  data-test="matrix-icon"
                  class="info-icon"
                ></ion-icon>
              </ion-button>
            </ion-item>
          </ion-row>
        </ion-radio-group>
      </ion-list>
    </ion-content>
  </ion-menu>
</div>
